<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Panza Verde Admin">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#2e7d32">
    <title>Panel Administrador - Panza Verde</title>
    <meta name="description" content="Panel de administración para gestionar productos de Panza Verde">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="admin.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="admin-page">
    <div class="admin-container">
        <!-- Login Screen -->
        <div class="admin-login-screen" id="admin-login-screen">
            <div class="admin-login-card">
                <div class="admin-login-header">
                    <img src="https://i.imgur.com/8zf86ss.png" alt="Logo Panza Verde" class="admin-logo">
                    <h1>Panel Administrador</h1>
                    <p>Acceso exclusivo para personal autorizado</p>
                </div>
                <form id="admin-login-form" class="admin-login-form">
                    <div class="form-group">
                        <label for="admin-email">
                            <i class="fas fa-envelope"></i> Correo electrónico
                        </label>
                        <input type="email" id="admin-email" name="email" placeholder="admin@panzaverde.com" required autocomplete="email">
                    </div>
                    <div class="form-group">
                        <label for="admin-password">
                            <i class="fas fa-lock"></i> Contraseña
                        </label>
                        <input type="password" id="admin-password" name="password" placeholder="••••••••" required autocomplete="current-password">
                    </div>
                    <button type="submit" class="btn-admin-login">
                        <i class="fas fa-sign-in-alt"></i> Iniciar sesión
                    </button>
                </form>
                <div class="admin-login-footer">
                    <a href="index.html" class="back-to-store">
                        <i class="fas fa-arrow-left"></i> Volver a la tienda
                    </a>
                </div>
            </div>
        </div>

        <!-- Dashboard Screen -->
        <div class="admin-dashboard-screen" id="admin-dashboard-screen" hidden>
            <!-- Left Sidebar Navigation -->
            <aside class="admin-sidebar" id="admin-sidebar">
                <div class="admin-sidebar-header">
                    <img src="https://i.imgur.com/8zf86ss.png" alt="Logo" class="admin-sidebar-logo">
                    <h2>Panza Verde</h2>
                    <button class="admin-sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
                <nav class="admin-sidebar-nav">
                    <a href="#admin-stats-section" class="admin-nav-item active" data-section="stats">
                        <i class="fas fa-chart-bar"></i>
                        <span>Dashboard</span>
                    </a>
                    <a href="#product-management" class="admin-nav-item" data-section="products">
                        <i class="fas fa-box"></i>
                        <span>Productos</span>
                    </a>
                    <a href="#category-management" class="admin-nav-item" data-section="categories">
                        <i class="fas fa-tags"></i>
                        <span>Categorías</span>
                    </a>
                    <a href="#orders-management" class="admin-nav-item" data-section="orders">
                        <i class="fas fa-shopping-cart"></i>
                        <span>Pedidos</span>
                    </a>
                    <a href="#blog-management" class="admin-nav-item" data-section="blog">
                        <i class="fas fa-blog"></i>
                        <span>Blog</span>
                    </a>
                    <a href="#buyers-management" class="admin-nav-item" data-section="buyers">
                        <i class="fas fa-users"></i>
                        <span>Compradores</span>
                    </a>
                    <a href="#business-manager" class="admin-nav-item" data-section="business">
                        <i class="fas fa-chart-line"></i>
                        <span>Business Manager</span>
                    </a>
                    <a href="#chatbot-management" class="admin-nav-item" data-section="chatbot">
                        <i class="fas fa-robot"></i>
                        <span>Chatbot</span>
                    </a>
                    <a href="#users-management" class="admin-nav-item" data-section="users">
                        <i class="fas fa-user-cog"></i>
                        <span>Usuarios</span>
                    </a>
                    <a href="#help-tutorial" class="admin-nav-item" data-section="help">
                        <i class="fas fa-question-circle"></i>
                        <span>Ayuda y Tutorial</span>
                    </a>
                </nav>
                <div class="admin-sidebar-footer">
                    <a href="index.html" class="admin-nav-item">
                        <i class="fas fa-store"></i>
                        <span>Ver Tienda</span>
                    </a>
                    <button id="admin-sidebar-logout-btn" class="admin-nav-item admin-logout-item">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Cerrar Sesión</span>
                    </button>
                </div>
            </aside>

            <div class="admin-content-wrapper">
                <header class="admin-header">
                    <div class="admin-header-content">
                        <div class="admin-header-left">
                            <button class="admin-mobile-menu-toggle" id="mobile-menu-toggle" aria-label="Toggle menu">
                                <i class="fas fa-bars"></i>
                            </button>
                            <div>
                                <h2>Panel Administrador</h2>
                                <p id="admin-welcome-text">Bienvenida, Erandi</p>
                            </div>
                        </div>
                        <div class="admin-header-right">
                            <a href="index.html" class="admin-nav-link" title="Ver tienda">
                                <i class="fas fa-store"></i>
                                <span class="admin-nav-text">Tienda</span>
                            </a>
                            <button id="admin-logout-btn" class="admin-logout-btn" title="Cerrar sesión">
                                <i class="fas fa-sign-out-alt"></i>
                                <span class="admin-nav-text">Salir</span>
                            </button>
                        </div>
                    </div>
                </header>

                <main class="admin-main">
                <!-- Stats Section -->
                <section class="admin-stats" id="admin-stats-section" style="display: none;">
                    <div class="stat-card">
                        <div class="stat-icon stat-icon-products">
                            <i class="fas fa-box"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="stat-total-products">0</h3>
                            <p>Productos totales</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon stat-icon-featured">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="stat-featured-products">0</h3>
                            <p>Productos destacados</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon stat-icon-categories">
                            <i class="fas fa-tags"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="stat-categories">0</h3>
                            <p>Categorías</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon stat-icon-value">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="stat-total-value">$0</h3>
                            <p>Valor inventario</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon stat-icon-orders">
                            <i class="fas fa-shopping-cart"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="stat-total-orders">0</h3>
                            <p>Pedidos totales</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon stat-icon-revenue">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="stat-total-revenue">$0</h3>
                            <p>Ingresos totales</p>
                        </div>
                    </div>
                </section>

                <!-- Product Management Section -->
                <section class="admin-section" id="product-management">
                    <div class="admin-section-header">
                        <h2><i class="fas fa-edit"></i> Gestionar Productos</h2>
                        <button id="new-product-btn" class="btn-new-product">
                            <i class="fas fa-plus"></i> Nuevo producto
                        </button>
                    </div>

                    <div class="admin-form-container" id="product-form-container">
                        <form id="product-form" class="admin-product-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="product-name">
                                        <i class="fas fa-tag"></i> Nombre del producto
                                    </label>
                                    <input type="text" id="product-name" name="name" placeholder="Ej: Gomitas de frutas" required>
                                </div>
                                <div class="form-group">
                                    <label for="product-price">
                                        <i class="fas fa-dollar-sign"></i> Precio (MXN)
                                    </label>
                                    <input type="number" id="product-price" name="price" min="0" step="0.01" placeholder="0.00" required>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="product-category">
                                        <i class="fas fa-folder"></i> Categoría
                                    </label>
                                    <select id="product-category" name="category" required>
                                        <option value="Dulces">Dulces</option>
                                        <option value="Dulces picositos">Dulces picositos</option>
                                        <option value="Botanas">Botanas</option>
                                        <option value="Otros">Otros</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="product-image">
                                        <i class="fas fa-image"></i> URL de imagen
                                    </label>
                                    <input type="url" id="product-image" name="img" placeholder="https://ejemplo.com/imagen.jpg">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="product-description">
                                    <i class="fas fa-align-left"></i> Descripción
                                </label>
                                <textarea id="product-description" name="includes" rows="3" placeholder="Descripción del producto, ingredientes, etc."></textarea>
                            </div>
                            <div class="form-group checkbox-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="product-featured" name="featured">
                                    <span><i class="fas fa-star"></i> Marcar como producto destacado</span>
                                </label>
                            </div>
                            <div class="form-actions">
                                <button type="button" id="clear-product-form" class="btn-secondary">
                                    <i class="fas fa-times"></i> Limpiar
                                </button>
                                <button type="submit" class="btn-primary" id="product-form-submit">
                                    <i class="fas fa-save"></i> Guardar producto
                                </button>
                            </div>
                        </form>
                    </div>
                </section>

                <!-- Category Management Section -->
                <section class="admin-section" id="category-management">
                    <div class="admin-section-header">
                        <h2><i class="fas fa-tags"></i> Gestionar Categorías</h2>
                        <button id="new-category-btn" class="btn-new-product">
                            <i class="fas fa-plus"></i> Nueva categoría
                        </button>
                    </div>
                    <div class="admin-form-container" id="category-form-container" style="display: none;">
                        <form id="category-form" class="admin-product-form">
                            <div class="form-group">
                                <label for="category-name">
                                    <i class="fas fa-tag"></i> Nombre de la categoría
                                </label>
                                <input type="text" id="category-name" name="name" placeholder="Ej: Snacks saludables" required>
                            </div>
                            <div class="form-actions">
                                <button type="button" id="cancel-category-form" class="btn-secondary">
                                    <i class="fas fa-times"></i> Cancelar
                                </button>
                                <button type="submit" class="btn-primary" id="category-form-submit">
                                    <i class="fas fa-save"></i> Guardar categoría
                                </button>
                            </div>
                        </form>
                    </div>
                    <div id="admin-categories-list" class="admin-categories-list"></div>
                </section>

                <!-- Products List Section -->
                <section class="admin-section">
                    <div class="admin-section-header">
                        <h2><i class="fas fa-list"></i> Lista de Productos</h2>
                        <div class="admin-actions">
                            <button id="seed-catalog-btn" class="btn-seed-catalog">
                                <i class="fas fa-bolt"></i> Importar catálogo base
                            </button>
                            <input type="text" id="admin-search" class="admin-search" placeholder="Buscar productos...">
                        </div>
                    </div>
                    <div id="admin-product-list" class="admin-product-list"></div>
                </section>

                <!-- Orders Management Section -->
                <section class="admin-section" id="orders-management">
                    <div class="admin-section-header">
                        <h2><i class="fas fa-shopping-cart"></i> Gestionar Pedidos</h2>
                        <div class="admin-actions">
                            <button id="new-order-btn" class="btn-new-product">
                                <i class="fas fa-plus"></i> Crear pedido
                            </button>
                            <input type="text" id="admin-order-search" class="admin-search" placeholder="Buscar pedidos...">
                        </div>
                    </div>
                    
                    <!-- Order Creation Form -->
                    <div class="admin-form-container" id="order-form-container" style="display: none;">
                        <form id="order-form" class="admin-product-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="order-customer-name">
                                        <i class="fas fa-user"></i> Nombre del cliente
                                    </label>
                                    <input type="text" id="order-customer-name" name="customerName" placeholder="Nombre completo" required>
                                </div>
                                <div class="form-group">
                                    <label for="order-customer-email">
                                        <i class="fas fa-envelope"></i> Correo del cliente
                                    </label>
                                    <input type="email" id="order-customer-email" name="customerEmail" placeholder="cliente@email.com" required>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="order-payment-method">
                                        <i class="fas fa-credit-card"></i> Método de pago
                                    </label>
                                    <select id="order-payment-method" name="paymentMethod" required>
                                        <option value="en línea">En línea (PayPal)</option>
                                        <option value="efectivo">Efectivo</option>
                                        <option value="Transferencia">Transferencia</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="order-status">
                                        <i class="fas fa-info-circle"></i> Estado inicial
                                    </label>
                                    <select id="order-status" name="status" required>
                                        <option value="pendiente">Pendiente</option>
                                        <option value="confirmado">Confirmado</option>
                                        <option value="en_preparacion">En preparación</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>
                                    <i class="fas fa-shopping-bag"></i> Productos del pedido
                                </label>
                                <div id="order-items-container" class="order-items-container">
                                    <div class="order-item-row">
                                        <select class="order-product-select" required>
                                            <option value="">Seleccionar producto</option>
                                        </select>
                                        <input type="number" class="order-quantity-input" min="1" value="1" placeholder="Cantidad" required>
                                        <button type="button" class="btn-remove-order-item" onclick="removeOrderItem(this)">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                </div>
                                <button type="button" class="btn-secondary" onclick="addOrderItem()" style="margin-top: 0.5rem;">
                                    <i class="fas fa-plus"></i> Agregar producto
                                </button>
                            </div>
                            <div class="form-group">
                                <label>
                                    <i class="fas fa-dollar-sign"></i> Total calculado
                                </label>
                                <div id="order-total-display" class="order-total-display">$0.00</div>
                            </div>
                            <div class="form-actions">
                                <button type="button" id="cancel-order-form" class="btn-secondary">
                                    <i class="fas fa-times"></i> Cancelar
                                </button>
                                <button type="submit" class="btn-primary" id="order-form-submit">
                                    <i class="fas fa-save"></i> Crear pedido
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <div id="admin-orders-list" class="admin-orders-list"></div>
                </section>

                <!-- Blog Management Section -->
                <section class="admin-section" id="blog-management">
                    <div class="admin-section-header">
                        <h2><i class="fas fa-blog"></i> Gestionar Blog</h2>
                        <div class="admin-actions">
                            <button id="create-seo-blog-posts" class="btn-secondary">
                                <i class="fas fa-magic"></i> Crear artículos SEO
                            </button>
                            <button id="new-blog-btn" class="btn-new-product">
                                <i class="fas fa-plus"></i> Nuevo artículo
                            </button>
                        </div>
                    </div>

                    <div class="admin-form-container" id="blog-form-container" style="display: none;">
                        <form id="blog-form" class="admin-product-form">
                            <div class="form-group">
                                <label for="blog-title">
                                    <i class="fas fa-heading"></i> Título del artículo
                                </label>
                                <input type="text" id="blog-title" name="title" placeholder="Ej: La Tradición de la Dulcería Mexicana" required>
                            </div>
                            <div class="form-group">
                                <label for="blog-excerpt">
                                    <i class="fas fa-align-left"></i> Resumen (excerpt)
                                </label>
                                <textarea id="blog-excerpt" name="excerpt" rows="2" placeholder="Breve descripción del artículo..." required></textarea>
                            </div>
                            <div class="form-group">
                                <label for="blog-content">
                                    <i class="fas fa-file-alt"></i> Contenido completo
                                </label>
                                <textarea id="blog-content" name="content" rows="10" placeholder="Contenido completo del artículo en HTML..." required></textarea>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="blog-category">
                                        <i class="fas fa-tag"></i> Categoría
                                    </label>
                                    <input type="text" id="blog-category" name="category" placeholder="Ej: Tradición, Ingredientes, Sabores" required>
                                </div>
                                <div class="form-group">
                                    <label for="blog-image">
                                        <i class="fas fa-image"></i> URL de imagen
                                    </label>
                                    <input type="url" id="blog-image" name="image" placeholder="https://ejemplo.com/imagen.jpg">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="blog-author">
                                    <i class="fas fa-user"></i> Autor
                                </label>
                                <input type="text" id="blog-author" name="author" placeholder="Panza Verde" value="Panza Verde">
                            </div>
                            <div class="form-actions">
                                <button type="button" id="cancel-blog-form" class="btn-secondary">
                                    <i class="fas fa-times"></i> Cancelar
                                </button>
                                <button type="submit" class="btn-primary">
                                    <i class="fas fa-save"></i> Guardar artículo
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <div id="admin-blog-list" class="admin-blog-list"></div>
                </section>

                <!-- Buyers Management Section -->
                <section class="admin-section" id="buyers-management">
                    <div class="admin-section-header">
                        <h2><i class="fas fa-users"></i> Información de Compradores</h2>
                    </div>
                    <div id="admin-buyers-list" class="admin-buyers-list"></div>
                </section>

                <!-- Users Management Section -->
                <section class="admin-section" id="users-management">
                    <div class="admin-section-header">
                        <h2><i class="fas fa-user-cog"></i> Gestión de Usuarios</h2>
                        <button id="new-user-btn" class="btn-new-product">
                            <i class="fas fa-plus"></i> Nuevo usuario
                        </button>
                    </div>
                    
                    <div class="admin-form-container" id="user-form-container" style="display: none;">
                        <form id="user-form" class="admin-product-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="user-name">
                                        <i class="fas fa-user"></i> Nombre completo
                                    </label>
                                    <input type="text" id="user-name" name="name" placeholder="Nombre completo" required>
                                </div>
                                <div class="form-group">
                                    <label for="user-email">
                                        <i class="fas fa-envelope"></i> Correo electrónico
                                    </label>
                                    <input type="email" id="user-email" name="email" placeholder="usuario@email.com" required>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="user-password">
                                    <i class="fas fa-lock"></i> Contraseña
                                </label>
                                <input type="password" id="user-password" name="password" placeholder="Mínimo 6 caracteres" minlength="6" required>
                            </div>
                            <div class="form-actions">
                                <button type="button" id="cancel-user-form" class="btn-secondary">
                                    <i class="fas fa-times"></i> Cancelar
                                </button>
                                <button type="submit" class="btn-primary" id="user-form-submit">
                                    <i class="fas fa-save"></i> Crear usuario
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <div id="admin-users-list" class="admin-users-list"></div>
                </section>

                <!-- Business Manager Section -->
                <section class="admin-section" id="business-manager">
                    <div class="admin-section-header">
                        <h2><i class="fas fa-chart-line"></i> Business Manager - Gestión de Inventario</h2>
                        <div class="admin-actions">
                            <button id="download-data-btn" class="btn-secondary">
                                <i class="fas fa-download"></i> Descargar Datos
                            </button>
                            <button id="ai-insights-btn" class="btn-secondary">
                                <i class="fas fa-brain"></i> Insights de IA
                            </button>
                        </div>
                    </div>

                    <!-- Inventory Management -->
                    <div class="admin-section-header">
                        <h3><i class="fas fa-boxes"></i> Gestión de Inventario</h3>
                        <div class="admin-actions">
                            <button id="add-inventory-btn" class="btn-new-product">
                                <i class="fas fa-plus"></i> Agregar Inventario
                            </button>
                            <button id="bulk-upload-inventory-btn" class="btn-secondary">
                                <i class="fas fa-upload"></i> Carga Masiva
                            </button>
                        </div>
                    </div>

                    <div class="admin-form-container" id="inventory-form-container" style="display: none;">
                        <form id="inventory-form" class="admin-product-form">
                            <div class="form-group">
                                <label for="inventory-product-select">
                                    <i class="fas fa-box"></i> Producto
                                </label>
                                <select id="inventory-product-select" name="productId" required>
                                    <option value="">Seleccionar producto</option>
                                </select>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="inventory-quantity">
                                        <i class="fas fa-hashtag"></i> Cantidad en Stock
                                    </label>
                                    <input type="number" id="inventory-quantity" name="quantity" min="0" placeholder="0" required>
                                </div>
                                <div class="form-group">
                                    <label for="inventory-min-stock">
                                        <i class="fas fa-exclamation-triangle"></i> Stock Mínimo (Alerta)
                                    </label>
                                    <input type="number" id="inventory-min-stock" name="minStock" min="0" placeholder="10">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="inventory-location">
                                    <i class="fas fa-map-marker-alt"></i> Ubicación/Almacén
                                </label>
                                <input type="text" id="inventory-location" name="location" placeholder="Ej: Almacén Principal">
                            </div>
                            <div class="form-group">
                                <label for="inventory-notes">
                                    <i class="fas fa-sticky-note"></i> Notas
                                </label>
                                <textarea id="inventory-notes" name="notes" rows="2" placeholder="Notas adicionales sobre el inventario..."></textarea>
                            </div>
                            <div class="form-actions">
                                <button type="button" id="cancel-inventory-form" class="btn-secondary">
                                    <i class="fas fa-times"></i> Cancelar
                                </button>
                                <button type="submit" class="btn-primary" id="inventory-form-submit">
                                    <i class="fas fa-save"></i> Guardar Inventario
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Bulk Upload Form -->
                    <div class="admin-form-container" id="bulk-inventory-form-container" style="display: none; margin-top: 1rem;">
                        <div class="admin-section-header">
                            <h4><i class="fas fa-file-upload"></i> Carga Masiva de Inventario</h4>
                            <p>Sube un archivo CSV o ingresa datos manualmente en formato: Producto, Cantidad, Stock Mínimo</p>
                        </div>
                        <form id="bulk-inventory-form" class="admin-product-form">
                            <div class="form-group">
                                <label for="bulk-inventory-data">
                                    <i class="fas fa-file-csv"></i> Datos de Inventario (CSV o texto)
                                </label>
                                <textarea id="bulk-inventory-data" name="bulkData" rows="10" placeholder="Formato: Nombre del Producto, Cantidad, Stock Mínimo&#10;Ejemplo:&#10;Gomitas de frutos (250g), 50, 10&#10;Alfajor argentino, 30, 5&#10;Mangos enchilados (100g), 25, 8"></textarea>
                            </div>
                            <div class="form-actions">
                                <button type="button" id="cancel-bulk-inventory-form" class="btn-secondary">
                                    <i class="fas fa-times"></i> Cancelar
                                </button>
                                <button type="submit" class="btn-primary">
                                    <i class="fas fa-upload"></i> Procesar Carga Masiva
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Inventory List -->
                    <div id="admin-inventory-list" class="admin-inventory-list"></div>

                    <!-- Advanced Analytics -->
                    <div class="admin-section-header" style="margin-top: 2rem;">
                        <h3><i class="fas fa-chart-bar"></i> Analytics Avanzados</h3>
                    </div>
                    <div class="analytics-dashboard" id="analytics-dashboard">
                        <div class="analytics-grid">
                            <div class="analytics-card">
                                <h4><i class="fas fa-box"></i> Valor Total Inventario</h4>
                                <div class="analytics-value" id="analytics-total-inventory-value">$0.00</div>
                                <p class="analytics-change" id="analytics-inventory-change">-</p>
                            </div>
                            <div class="analytics-card">
                                <h4><i class="fas fa-exclamation-triangle"></i> Productos Bajo Stock</h4>
                                <div class="analytics-value" id="analytics-low-stock-count">0</div>
                                <p class="analytics-change">Productos que requieren atención</p>
                            </div>
                            <div class="analytics-card">
                                <h4><i class="fas fa-chart-line"></i> Rotación de Inventario</h4>
                                <div class="analytics-value" id="analytics-turnover-rate">-</div>
                                <p class="analytics-change">Basado en ventas recientes</p>
                            </div>
                            <div class="analytics-card">
                                <h4><i class="fas fa-dollar-sign"></i> Productos Más Valiosos</h4>
                                <div class="analytics-value" id="analytics-top-value-count">0</div>
                                <p class="analytics-change">Por valor de inventario</p>
                            </div>
                        </div>
                        <div class="analytics-charts" id="analytics-charts">
                            <div class="chart-container">
                                <h4>Distribución de Inventario por Categoría</h4>
                                <canvas id="category-inventory-chart"></canvas>
                            </div>
                            <div class="chart-container">
                                <h4>Productos con Bajo Stock</h4>
                                <div id="low-stock-products-list"></div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Chatbot Management Section -->
                <section class="admin-section" id="chatbot-management">
                    <div class="admin-section-header">
                        <h2><i class="fas fa-robot"></i> Gestión del Chatbot</h2>
                        <div class="admin-actions">
                            <button id="refresh-chatbot-stats" class="btn-secondary">
                                <i class="fas fa-sync"></i> Actualizar estadísticas
                            </button>
                        </div>
                    </div>
                    
                    <!-- Chatbot Stats -->
                    <div class="admin-stats" id="chatbot-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                        <div class="stat-card">
                            <div class="stat-icon stat-icon-orders">
                                <i class="fas fa-comments"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="chatbot-total-messages">0</h3>
                                <p>Mensajes totales</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon stat-icon-revenue">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="chatbot-total-users">0</h3>
                                <p>Usuarios únicos</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon stat-icon-featured">
                                <i class="fas fa-exchange-alt"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="chatbot-total-conversations">0</h3>
                                <p>Conversaciones</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon stat-icon-value">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="chatbot-avg-response-time">-</h3>
                                <p>Tiempo promedio</p>
                            </div>
                        </div>
                    </div>

                    <!-- Chatbot Training Section -->
                    <div class="admin-section-header">
                        <h3><i class="fas fa-graduation-cap"></i> Entrenar Chatbot</h3>
                    </div>
                    <div class="admin-form-container" style="margin-bottom: 2rem;">
                        <form id="chatbot-training-form" class="admin-product-form">
                            <div class="form-group">
                                <label for="training-prompt">
                                    <i class="fas fa-comment-dots"></i> Pregunta o contexto
                                </label>
                                <input type="text" id="training-prompt" name="prompt" placeholder="Ej: ¿Cuál es el precio de las gomitas?" required>
                            </div>
                            <div class="form-group">
                                <label for="training-response">
                                    <i class="fas fa-reply"></i> Respuesta esperada
                                </label>
                                <textarea id="training-response" name="response" rows="4" placeholder="Ej: Las gomitas de frutas cuestan $45 MXN y vienen en presentación de 250g..." required></textarea>
                            </div>
                            <div class="form-actions">
                                <button type="submit" class="btn-primary" id="training-form-submit">
                                    <i class="fas fa-save"></i> Guardar entrenamiento
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Recent Conversations -->
                    <div class="admin-section-header">
                        <h3><i class="fas fa-history"></i> Conversaciones Recientes</h3>
                    </div>
                    <div id="admin-chatbot-conversations" class="admin-orders-list"></div>
                </section>

                <!-- Help and Tutorial Section -->
                <section class="admin-section" id="help-tutorial">
                    <div class="admin-section-header">
                        <h2><i class="fas fa-question-circle"></i> Ayuda y Tutorial</h2>
                        <div class="admin-actions">
                            <button id="generate-ai-help-btn" class="btn-secondary">
                                <i class="fas fa-magic"></i> Generar Ayuda con IA
                            </button>
                        </div>
                    </div>

                    <div class="tutorial-container">
                        <div class="tutorial-nav">
                            <button class="tutorial-tab active" data-tutorial="getting-started">
                                <i class="fas fa-play-circle"></i> Inicio Rápido
                            </button>
                            <button class="tutorial-tab" data-tutorial="inventory">
                                <i class="fas fa-boxes"></i> Gestión de Inventario
                            </button>
                            <button class="tutorial-tab" data-tutorial="products">
                                <i class="fas fa-box"></i> Productos
                            </button>
                            <button class="tutorial-tab" data-tutorial="orders">
                                <i class="fas fa-shopping-cart"></i> Pedidos
                            </button>
                            <button class="tutorial-tab" data-tutorial="analytics">
                                <i class="fas fa-chart-bar"></i> Analytics
                            </button>
                            <button class="tutorial-tab" data-tutorial="ai-features">
                                <i class="fas fa-brain"></i> Funciones de IA
                            </button>
                        </div>

                        <div class="tutorial-content">
                            <div class="tutorial-section active" id="tutorial-getting-started">
                                <h3>Bienvenida al Panel de Administración de Panza Verde</h3>
                                <p>Este panel te permite gestionar completamente tu tienda de dulces artesanales mexicanos.</p>
                                <h4>Funciones Principales:</h4>
                                <ul>
                                    <li><strong>Dashboard:</strong> Vista general de estadísticas y métricas clave</li>
                                    <li><strong>Business Manager:</strong> Gestión completa de inventario y analytics avanzados</li>
                                    <li><strong>Productos:</strong> Crear, editar y eliminar productos del catálogo</li>
                                    <li><strong>Categorías:</strong> Organizar productos por categorías</li>
                                    <li><strong>Pedidos:</strong> Gestionar y rastrear todos los pedidos</li>
                                    <li><strong>Blog:</strong> Crear contenido para tu blog con ayuda de IA</li>
                                    <li><strong>Chatbot:</strong> Entrenar y monitorear el asistente virtual</li>
                                </ul>
                                <h4>Navegación:</h4>
                                <p>Usa el menú lateral izquierdo para navegar entre secciones. Solo se mostrará la sección que selecciones.</p>
                            </div>

                            <div class="tutorial-section" id="tutorial-inventory">
                                <h3>Gestión de Inventario</h3>
                                <h4>Agregar Inventario a un Producto:</h4>
                                <ol>
                                    <li>Ve a la sección "Business Manager"</li>
                                    <li>Haz clic en "Cargar Inventario Masivo" o agrega productos individualmente</li>
                                    <li>Selecciona el producto y especifica la cantidad en stock</li>
                                    <li>Establece un stock mínimo para recibir alertas cuando esté bajo</li>
                                    <li>Guarda los cambios</li>
                                </ol>
                                <h4>Carga Masiva:</h4>
                                <p>Puedes cargar múltiples productos a la vez usando el formato CSV:</p>
                                <pre>Nombre del Producto, Cantidad, Stock Mínimo
Gomitas de frutos (250g), 50, 10
Alfajor argentino, 30, 5</pre>
                                <h4>Analytics de Inventario:</h4>
                                <p>El dashboard de analytics muestra:</p>
                                <ul>
                                    <li>Valor total del inventario</li>
                                    <li>Productos con bajo stock</li>
                                    <li>Rotación de inventario</li>
                                    <li>Distribución por categorías</li>
                                </ul>
                            </div>

                            <div class="tutorial-section" id="tutorial-products">
                                <h3>Gestión de Productos</h3>
                                <h4>Crear un Nuevo Producto:</h4>
                                <ol>
                                    <li>Ve a la sección "Productos"</li>
                                    <li>Haz clic en "Nuevo producto"</li>
                                    <li>Completa todos los campos requeridos (nombre, precio, categoría)</li>
                                    <li>Agrega una imagen (URL) y descripción</li>
                                    <li>Marca como destacado si deseas que aparezca en la página principal</li>
                                    <li>Guarda el producto</li>
                                </ol>
                                <h4>Editar un Producto:</h4>
                                <p>Haz clic en el botón de editar (lápiz) junto al producto que deseas modificar.</p>
                                <h4>Eliminar un Producto:</h4>
                                <p>Haz clic en el botón de eliminar (papelera). Esta acción no se puede deshacer.</p>
                            </div>

                            <div class="tutorial-section" id="tutorial-orders">
                                <h3>Gestión de Pedidos</h3>
                                <h4>Ver Pedidos:</h4>
                                <p>Todos los pedidos aparecen en la sección "Pedidos" ordenados por fecha (más recientes primero).</p>
                                <h4>Crear un Pedido Manual:</h4>
                                <ol>
                                    <li>Haz clic en "Crear pedido"</li>
                                    <li>Ingresa los datos del cliente</li>
                                    <li>Agrega productos al pedido</li>
                                    <li>Selecciona el método de pago y estado</li>
                                    <li>Guarda el pedido</li>
                                </ol>
                                <h4>Actualizar Estado de Pedido:</h4>
                                <p>Usa el menú desplegable en cada pedido para cambiar su estado: Pendiente, Confirmado, En preparación, Enviado, Entregado, o Cancelado.</p>
                            </div>

                            <div class="tutorial-section" id="tutorial-analytics">
                                <h3>Analytics y Reportes</h3>
                                <h4>Descargar Datos:</h4>
                                <p>Haz clic en "Descargar Datos" en Business Manager para exportar:</p>
                                <ul>
                                    <li>Inventario completo (CSV/JSON)</li>
                                    <li>Productos y categorías</li>
                                    <li>Pedidos y ventas</li>
                                    <li>Estadísticas y métricas</li>
                                </ul>
                                <h4>Insights de IA:</h4>
                                <p>Usa el botón "Insights de IA" para obtener recomendaciones inteligentes basadas en tus datos de inventario y ventas.</p>
                            </div>

                            <div class="tutorial-section" id="tutorial-ai-features">
                                <h3>Funciones de IA</h3>
                                <h4>Generación de Contenido para Blog:</h4>
                                <ol>
                                    <li>Ve a la sección "Blog"</li>
                                    <li>Haz clic en "Crear artículos SEO" para generar contenido automáticamente</li>
                                    <li>O crea artículos manualmente con ayuda de IA</li>
                                </ol>
                                <h4>Insights y Recomendaciones:</h4>
                                <p>La IA analiza tus datos y proporciona:</p>
                                <ul>
                                    <li>Sugerencias de productos a reabastecer</li>
                                    <li>Recomendaciones de precios</li>
                                    <li>Análisis de tendencias de ventas</li>
                                    <li>Sugerencias de marketing</li>
                                </ul>
                                <h4>Asistente Virtual:</h4>
                                <p>El chatbot en la esquina inferior derecha puede ayudarte con preguntas sobre el panel de administración.</p>
                            </div>
                        </div>
                    </div>
                </section>
                </main>
            </div>
        </div>
    </div>

    <div id="toast" class="toast" role="status" aria-live="polite"></div>

    <!-- Admin Chatbot Widget -->
    <div id="admin-chatbot" class="panza-chatbot">
        <div class="chatbot-toggle" id="admin-chatbot-toggle">
            <i class="fas fa-comments"></i>
        </div>
        <div class="chatbot-window" id="admin-chatbot-window">
            <div class="chatbot-header">
                <div class="chatbot-header-info">
                    <img src="https://i.imgur.com/8zf86ss.png" alt="Panza Verde" class="chatbot-logo">
                    <div>
                        <h3>Panza Verde Admin</h3>
                        <p>Asistente Virtual</p>
                    </div>
                </div>
                <button class="chatbot-close" id="admin-chatbot-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="chatbot-messages" id="admin-chatbot-messages">
                <div class="chatbot-message bot-message">
                    <div class="message-content">
                        <p>¡Hola! 👋 Soy el asistente de administración de Panza Verde. ¿En qué puedo ayudarte? Puedo ayudarte con información sobre pedidos, productos, usuarios y más.</p>
                    </div>
                </div>
            </div>
            <div class="chatbot-input-container">
                <input type="text" id="admin-chatbot-input" placeholder="Escribe tu mensaje..." autocomplete="off">
                <button id="admin-chatbot-send">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <script type="module" src="admin.js"></script>
    <script src="chatbot.js" defer></script>
</body>
</html>

